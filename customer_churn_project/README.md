## Описание проекта "Прогнозирование оттока клиентов банка"

Клиенты это основа успеха любого бизнеса, в том числе и банковской деятельности. Поэтому банки заинтересованы в создании условий для предотвращения оттока клиентов.

Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.

В проекте мы будем строить модель, которая спрогнозирует уйдёт клиент из банка в ближайшее время или нет.
Используем исторические данные о поведении клиентов и расторжении договоров с банком.

Построим модель с предельно большим значением F1-меры. Нижняя граница метрики F1 - 0.59. 

Дополнительно измеряйте AUC-ROC, сравнивайте её значение с F1-мерой.

**Цель: Построить модель с предельно большим значением меры F1**

### План

Шаг 1. Изучение общей информации данных.

Шаг 2. Предобработка данных.

Шаг 3. Исследование баланса данных.

Шаг 4. Построение модели без учета дисбаланса данных. Выводы.

Шаг 5. Улучшение качества модели, учитывая дисбаланс классов. Обучаем разные модели и найдим лучшую. Выводы.

Шаг 6. Проводим финальное тестирование.

### Выводы

 - Были изучены данные. Выполнена предообработка, проведен разведочный анализ данных. 
 - Разбиты данные на тренировочную, валидационную и тестовую выборку.
 - Установлен факт несбалансируемых классов.
 - Проверены модели на данных без балансировки классов. 
 - Выполнен подбор гиперпараметров с помощью GridSearch.
 - В качестве контрольной метрики используем F1 меру.   
 - Для борьбы с дисбалансом были использованы 3 метода, лучше всего себя показал метод взвешенных классов на модели Случайного леса.
 - Проведен финальный тест.
    - используемая модель: Random Forest
    - параметры: {'bootstrap': True,
                  'ccp_alpha': 0.0,
                 'class_weight': 'balanced',
                 'criterion': 'gini',
                 'max_depth': None,
                 'max_features': 'auto',
                 'max_leaf_nodes': None,
                 'max_samples': None,
                 'min_impurity_decrease': 0.0,
                 'min_samples_leaf': 4,
                 'min_samples_split': 2,
                 'min_weight_fraction_leaf': 0.0,
                 'n_estimators': 100,
                 'n_jobs': None,
                 'oob_score': False,
                 'random_state': 12345,
                 'verbose': 0,
                 'warm_start': False}
    - полученные метрики:
        - accuracy = 0.855
        - recall = 0.648649
        - precision = 0.642336
        - ***f1_score = 0.645477***
        - aux_roc = 0.867513
    - проверили модели на вменяемость, сравнением с константной моделью.
    - рассмотрели важность признаков.
